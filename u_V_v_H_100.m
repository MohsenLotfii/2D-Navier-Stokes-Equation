u = [
-0.209202
-0.208542
-0.17663
-0.161507
-0.0811529
-0.0678878
0.0268773
0.160361
0.256394
0.364806
0.498463
0.611338
0.732581
0.866238
0.983297];

y = [
0.499661
0.420818
0.607275
0.300095
0.697769
0.112597
0.788159
0.836843
0.860943
0.905686
0.933623
0.945134
0.956576
0.984513
0.995989];

x = [
0.008521
0.0505727
0.0884192
0.130471
0.184695
0.255353
0.342389
0.412494
0.465888
0.502739
0.564212
0.600952
0.649864
0.711171
0.760527
0.831019
0.894151
0.940408
0.949427
0.971062];

v = [
0.0160682
0.0564046
0.0927074
0.133044
0.153478
0.162043
0.154739
0.1233
0.0837271
0.0480219
-0.00748631
-0.0511924
-0.114801
-0.182311
-0.213916
-0.217352
-0.152847
-0.108477
-0.0564046
0.00776849];

%for 20*20 grid :

u_exact_20 = [-0.04775];
v_exact_20 = [0.10091];

x_20 = [ 0    0.0500    0.1000    0.1500    0.2000    0.2500    0.3000    0.3500    0.4000    0.4500    0.5000...
    0.5500    0.6000    0.6500    0.7000    0.7500    0.8000    0.8500    0.9000    1.0000];
y_20 = [ 0    0.0500    0.1000    0.1500    0.2000    0.2500    0.3000    0.3500    0.4000    0.4500    0.5000...
    0.5500    0.6000    0.6500    0.7000    0.7500    0.8000    0.8500    0.9000    1.0000 ];


u_20=  [ -0.0187   -0.0487   -0.0747   -0.0985   -0.1212   -0.1430   -0.1631   -0.1800   -0.1913   -0.1942   -0.1860...
   -0.1647   -0.1295   -0.0811   -0.0205    0.0538    0.1503    0.2895    0.5039    0.9178];
   
v_20 =[
    0.0436
    0.1020
    0.1382
    0.1576
    0.1645
    0.1618
    0.1511
    0.1330
    0.1075
    0.0741
    0.0329
   -0.0157
   -0.0698
   -0.1265
   -0.1798
   -0.2206
   -0.2368
   -0.2154
   -0.1501
   -0.0517];

 Error_u20 = abs(u_exact_20 -u_20(10))
 Error_v20 = abs(v_exact_20 -v_20(10))
 

%for 40*40 grid :
u_exact_40 = [-0.05328];
v_exact_40 = [0.15607];
x_40 = [ 0    0.0250    0.0500    0.0750    0.1000    0.1250    0.1500    0.1750    0.2000    0.2250    0.2500...
    0.2750    0.3000    0.3250    0.3500    0.3750    0.4000    0.4250    0.4500    0.4750    0.5000    0.5250...
    0.5500    0.5750    0.6000    0.6250    0.6500    0.6750    0.7000    0.7250    0.7500    0.7750    0.8000...
    0.8250    0.8500    0.8750    0.9000    0.9250    0.9500    1.0000];
y_40 = [ 0    0.0250    0.0500    0.0750    0.1000    0.1250    0.1500    0.1750    0.2000    0.2250    0.2500...
     0.2750    0.3000    0.3250    0.3500    0.3750    0.4000    0.4250    0.4500    0.4750    0.5000    0.5250...
    0.5500    0.5750    0.6000    0.6250    0.6500    0.6750    0.7000    0.7250    0.7500    0.7750    0.8000...
    0.8250    0.8500    0.8750    0.9000    0.9250    0.9500    1.0000];
u_40 = [ -0.0098   -0.0266   -0.0420   -0.0562   -0.0695   -0.0822   -0.0946   -0.1066   -0.1185   -0.1302   -0.1417...
   -0.1529   -0.1636   -0.1736   -0.1826   -0.1903   -0.1963   -0.2003   -0.2018   -0.2004   -0.1959   -0.1880...
   -0.1765   -0.1614   -0.1428   -0.1208   -0.0955   -0.0671   -0.0358   -0.0014    0.0366    0.0792    0.1282...
    0.1861    0.2565    0.3438    0.4523    0.5852    0.7419    0.9549];
v_40 = [  
    0.0239
    0.0619
    0.0929
    0.1177
    0.1368
    0.1510
    0.1610
    0.1674
    0.1707
    0.1713
    0.1696
    0.1657
    0.1598
    0.1520
    0.1422
    0.1305
    0.1169
    0.1012
    0.0835
    0.0637
    0.0420
    0.0183
   -0.0072
   -0.0343
   -0.0626
   -0.0917
   -0.1210
   -0.1498
   -0.1768
   -0.2010
   -0.2209
   -0.2348
   -0.2412
   -0.2383
   -0.2253
   -0.2014
   -0.1674
   -0.1248
   -0.0762
   -0.0250];
Error_u40 = abs(u_exact_40 -u_40(20))
Error_v40 = abs(v_exact_40 -v_40(20))

%for 80*80 grid :
u_exact_80 = [-0.16402];
v_exact_80 = [0.14331];
x_80 = [ 0    0.0125    0.0250    0.0375    0.0500    0.0625    0.0750    0.0875    0.1000    0.1125    0.1250...
    0.1375    0.1500    0.1625    0.1750    0.1875    0.2000    0.2125    0.2250    0.2375    0.2500    0.2625...
    0.2750    0.2875    0.3000    0.3125    0.3250    0.3375    0.3500    0.3625    0.3750    0.3875    0.4000...
    0.4125    0.4250    0.4375    0.4500    0.4625    0.4750    0.4875    0.5000    0.5125    0.5250    0.5375...
    0.5500    0.5625    0.5750    0.5875    0.6000    0.6125    0.6250    0.6375    0.6500    0.6625    0.6750...
    0.6875    0.7000    0.7125    0.7250    0.7375    0.7500    0.7625    0.7750    0.7875    0.8000    0.8125...
    0.8250    0.8375    0.8500    0.8625    0.8750    0.8875    0.9000    0.9125    0.9250    0.9375    0.9500...
    0.9625    0.9750    1.0000];
y_80 = [ 0    0.0125    0.0250    0.0375    0.0500    0.0625    0.0750    0.0875    0.1000    0.1125    0.1250...
    0.1375    0.1500    0.1625    0.1750    0.1875    0.2000    0.2125    0.2250    0.2375    0.2500    0.2625...
    0.2750    0.2875    0.3000    0.3125    0.3250    0.3375    0.3500    0.3625    0.3750    0.3875    0.4000...
    0.4125    0.4250    0.4375    0.4500    0.4625    0.4750    0.4875    0.5000    0.5125    0.5250    0.5375...
    0.5500    0.5625    0.5750    0.5875    0.6000    0.6125    0.6250    0.6375    0.6500    0.6625    0.6750...
    0.6875    0.7000    0.7125    0.7250    0.7375    0.7500    0.7625    0.7750    0.7875    0.8000    0.8125...
    0.8250    0.8375    0.8500    0.8625    0.8750    0.8875    0.9000    0.9125    0.9250    0.9375    0.9500...
    0.9625    0.9750    1.0000];
u_80 = [-0.0051   -0.0140   -0.0225   -0.0306   -0.0383   -0.0457   -0.0528   -0.0597   -0.0664   -0.0730   -0.0794...
   -0.0857   -0.0919   -0.0980   -0.1041   -0.1102   -0.1162   -0.1221   -0.1280   -0.1339   -0.1397   -0.1455...
   -0.1511   -0.1567   -0.1621   -0.1674   -0.1725   -0.1773   -0.1819   -0.1862   -0.1901   -0.1936   -0.1967...
   -0.1992   -0.2012   -0.2026   -0.2033   -0.2034   -0.2027   -0.2012   -0.1989   -0.1957   -0.1917   -0.1868...
   -0.1810   -0.1742   -0.1666   -0.1580   -0.1486   -0.1383   -0.1271   -0.1152   -0.1024   -0.0888   -0.0745...
   -0.0595   -0.0437   -0.0272   -0.0098    0.0083    0.0274    0.0476    0.0690    0.0919    0.1164    0.1430...
    0.1721    0.2040    0.2393    0.2786    0.3223    0.3712    0.4255    0.4859    0.5524    0.6250    0.7032...
    0.7860    0.8719    0.9588];
v_80 = [    
    0.0127
    0.0339
    0.0532
    0.0707
    0.0865
    0.1006
    0.1131
    0.1242
    0.1339
    0.1423
    0.1494
    0.1555
    0.1605
    0.1646
    0.1678
    0.1702
    0.1718
    0.1727
    0.1730
    0.1727
    0.1718
    0.1703
    0.1683
    0.1657
    0.1627
    0.1592
    0.1552
    0.1507
    0.1457
    0.1403
    0.1343
    0.1279
    0.1209
    0.1135
    0.1056
    0.0971
    0.0881
    0.0787
    0.0687
    0.0581
    0.0471
    0.0356
    0.0236
    0.0112
   -0.0017
   -0.0150
   -0.0287
   -0.0427
   -0.0569
   -0.0715
   -0.0861
   -0.1009
   -0.1157
   -0.1303
   -0.1448
   -0.1589
   -0.1724
   -0.1854
   -0.1974
   -0.2085
   -0.2184
   -0.2268
   -0.2336
   -0.2386
   -0.2415
   -0.2423
   -0.2406
   -0.2364
   -0.2297
   -0.2202
   -0.2081
   -0.1934
   -0.1763
   -0.1569
   -0.1356
   -0.1126
   -0.0884
   -0.0633
   -0.0378
   -0.0123];
Error_u80 = abs(u_exact_80 -u_80(40))
Error_v80 = abs(v_exact_80 -v_80(40))


%for 160*160 grid :
u_exact_160 = [-0.13641];
v_exact_160 = [-0.06079];
x_160 = [0    0.0063    0.0125    0.0187    0.0250    0.0313    0.0375    0.0437    0.0500    0.0563    0.0625...
    0.0688    0.0750    0.0813    0.0875    0.0938    0.1000    0.1063    0.1125    0.1187    0.1250    0.1313...
    0.1375    0.1437    0.1500    0.1563    0.1625    0.1688    0.1750    0.1812    0.1875    0.1938    0.2000...
    0.2062    0.2125    0.2188    0.2250    0.2313    0.2375    0.2437    0.2500    0.2562    0.2625    0.2687...
    0.2750    0.2813    0.2875    0.2938    0.3000    0.3063    0.3125    0.3187    0.3250    0.3312    0.3375...
    0.3438    0.3500    0.3563    0.3625    0.3688    0.3750    0.3812    0.3875    0.3937    0.4000    0.4063...
    0.4125    0.4188    0.4250    0.4313    0.4375    0.4437    0.4500    0.4562    0.4625    0.4688    0.4750...
    0.4813    0.4875    0.4938    0.5000    0.5062    0.5125    0.5188    0.5250    0.5313    0.5375    0.5437...
    0.5500    0.5563    0.5625    0.5687    0.5750    0.5813    0.5875    0.5938    0.6000    0.6062    0.6125...
    0.6188    0.6250    0.6312    0.6375    0.6438    0.6500    0.6563    0.6625    0.6687    0.6750    0.6813...
    0.6875    0.6937    0.7000    0.7063    0.7125    0.7188    0.7250    0.7312    0.7375    0.7438    0.7500...
    0.7562    0.7625    0.7688    0.7750    0.7813    0.7875    0.7937    0.8000    0.8063    0.8125    0.8187...
    0.8250    0.8313    0.8375    0.8438    0.8500    0.8562    0.8625    0.8688    0.8750    0.8812    0.8875...
    0.8938    0.9000    0.9063    0.9125    0.9187    0.9250    0.9313    0.9375    0.9437    0.9500    0.9563...
    0.9625    0.9688    0.9750    0.9812    0.9875    1.0000];
y_160 = [0    0.0063    0.0125    0.0187    0.0250    0.0313    0.0375    0.0437    0.0500    0.0563    0.0625...
    0.0688    0.0750    0.0813    0.0875    0.0938    0.1000    0.1063    0.1125    0.1187    0.1250    0.1313...
    0.1375    0.1437    0.1500    0.1563    0.1625    0.1688    0.1750    0.1812    0.1875    0.1938    0.2000...
    0.2062    0.2125    0.2188    0.2250    0.2313    0.2375    0.2437    0.2500    0.2562    0.2625    0.2687...
    0.2750    0.2813    0.2875    0.2938    0.3000    0.3063    0.3125    0.3187    0.3250    0.3312    0.3375...
    0.3438    0.3500    0.3563    0.3625    0.3688    0.3750    0.3812    0.3875    0.3937    0.4000    0.4063...
    0.4125    0.4188    0.4250    0.4313    0.4375    0.4437    0.4500    0.4562    0.4625    0.4688    0.4750...
    0.4813    0.4875    0.4938    0.5000    0.5062    0.5125    0.5188    0.5250    0.5313    0.5375    0.5437...
    0.5500    0.5563    0.5625    0.5687    0.5750    0.5813    0.5875    0.5938    0.6000    0.6062    0.6125...
    0.6188    0.6250    0.6312    0.6375    0.6438    0.6500    0.6563    0.6625    0.6687    0.6750    0.6813...
    0.6875    0.6937    0.7000    0.7063    0.7125    0.7188    0.7250    0.7312    0.7375    0.7438    0.7500...
    0.7562    0.7625    0.7688    0.7750    0.7813    0.7875    0.7937    0.8000    0.8063    0.8125    0.8187...
    0.8250    0.8313    0.8375    0.8438    0.8500    0.8562    0.8625    0.8688    0.8750    0.8812    0.8875...
    0.8938    0.9000    0.9063    0.9125    0.9187    0.9250    0.9313    0.9375    0.9437    0.9500    0.9563...
    0.9625    0.9688    0.9750    0.9812    0.9875    1.0000];
u_160 = [   -0.0027   -0.0073   -0.0118   -0.0161   -0.0203   -0.0245   -0.0285   -0.0324   -0.0363   -0.0401   -0.0438...
   -0.0474   -0.0510   -0.0545   -0.0580   -0.0615   -0.0648   -0.0682   -0.0715   -0.0748   -0.0780   -0.0813...
   -0.0845   -0.0877   -0.0908   -0.0940   -0.0971   -0.1002   -0.1034   -0.1065   -0.1096   -0.1127   -0.1158...
   -0.1188   -0.1219   -0.1250   -0.1281   -0.1311   -0.1342   -0.1372   -0.1402   -0.1432   -0.1462   -0.1492...
   -0.1522   -0.1551   -0.1580   -0.1609   -0.1637   -0.1665   -0.1693   -0.1720   -0.1746   -0.1772   -0.1798...
   -0.1823   -0.1847   -0.1870   -0.1892   -0.1913   -0.1934   -0.1953   -0.1972   -0.1989   -0.2004   -0.2019...
   -0.2032   -0.2044   -0.2054   -0.2062   -0.2069   -0.2074   -0.2078   -0.2079   -0.2079   -0.2077   -0.2073...
   -0.2066   -0.2058   -0.2047   -0.2034   -0.2019   -0.2002   -0.1982   -0.1961   -0.1936   -0.1910   -0.1881...
   -0.1850   -0.1816   -0.1780   -0.1742   -0.1701   -0.1659   -0.1613   -0.1566   -0.1516   -0.1465   -0.1410...
   -0.1354   -0.1296   -0.1236   -0.1174   -0.1109   -0.1043   -0.0975   -0.0905   -0.0834   -0.0760   -0.0685...
   -0.0608   -0.0529   -0.0448   -0.0366   -0.0282   -0.0195   -0.0108   -0.0018    0.0074    0.0168    0.0265...
    0.0364    0.0465    0.0570    0.0677    0.0788    0.0903    0.1021    0.1144    0.1272    0.1405    0.1544...
    0.1689    0.1841    0.2001    0.2169    0.2345    0.2531    0.2728    0.2935    0.3154    0.3385    0.3630...
    0.3888    0.4160    0.4447    0.4748    0.5065    0.5397    0.5745    0.6106    0.6482    0.6871    0.7271...
    0.7681    0.8100    0.8524    0.8952    0.9381    0.9807];
v_160 = [
    0.0070
    0.0181
    0.0288
    0.0389
    0.0487
    0.0579
    0.0667
    0.0751
    0.0831
    0.0906
    0.0977
    0.1044
    0.1108
    0.1167
    0.1223
    0.1276
    0.1325
    0.1371
    0.1413
    0.1453
    0.1489
    0.1523
    0.1554
    0.1583
    0.1609
    0.1632
    0.1653
    0.1672
    0.1689
    0.1703
    0.1716
    0.1727
    0.1736
    0.1743
    0.1748
    0.1752
    0.1754
    0.1755
    0.1754
    0.1751
    0.1747
    0.1742
    0.1735
    0.1727
    0.1718
    0.1707
    0.1695
    0.1681
    0.1667
    0.1651
    0.1634
    0.1615
    0.1595
    0.1574
    0.1552
    0.1529
    0.1504
    0.1478
    0.1451
    0.1422
    0.1393
    0.1362
    0.1329
    0.1296
    0.1261
    0.1224
    0.1187
    0.1148
    0.1108
    0.1066
    0.1023
    0.0979
    0.0933
    0.0886
    0.0838
    0.0788
    0.0737
    0.0685
    0.0631
    0.0576
    0.0520
    0.0462
    0.0403
    0.0342
    0.0281
    0.0218
    0.0154
    0.0089
    0.0022
   -0.0045
   -0.0114
   -0.0184
   -0.0254
   -0.0326
   -0.0398
   -0.0471
   -0.0545
   -0.0620
   -0.0695
   -0.0771
   -0.0847
   -0.0923
   -0.1000
   -0.1076
   -0.1152
   -0.1229
   -0.1304
   -0.1380
   -0.1454
   -0.1528
   -0.1600
   -0.1671
   -0.1741
   -0.1809
   -0.1875
   -0.1939
   -0.2001
   -0.2060
   -0.2116
   -0.2169
   -0.2219
   -0.2265
   -0.2306
   -0.2344
   -0.2378
   -0.2406
   -0.2430
   -0.2448
   -0.2461
   -0.2468
   -0.2469
   -0.2465
   -0.2454
   -0.2436
   -0.2412
   -0.2382
   -0.2344
   -0.2300
   -0.2250
   -0.2193
   -0.2129
   -0.2059
   -0.1982
   -0.1900
   -0.1812
   -0.1718
   -0.1619
   -0.1516
   -0.1407
   -0.1295
   -0.1180
   -0.1061
   -0.0940
   -0.0816
   -0.0691
   -0.0565
   -0.0438
   -0.0311
   -0.0185
   -0.0059];
Error_u160 = abs(u_exact_160 -u_160(80))
Error_v160 = abs(v_exact_160 -v_160(80))

% figure(4)
% plot(u,y,'*m')
% hold on
% plot(u_20,y_20,'--*k')
% hold on
% plot(u_40,y_40,'--sb')
% hold on
% plot(u_80,y_80,'--og')
% hold on 
% plot(u_160,y_160,'--^r')
% title('u_y')
% xlabel('u')
% ylabel('y')
% legend('EXACT','20*20','40*40','80*80','160*160')

figure(5)
plot(x,v,'*m')
hold on
plot(x_20,v_20,'--*k')
hold on
plot(x_40,v_40,'--sb')
hold on
plot(x_80,v_80,'--og')
hold on 
plot(x_160,v_160,'--^r')
title('v_x')
xlabel('x')
ylabel('v')
legend('EXACT','20*20','40*40','80*80','160*160')

 

% figure(3)
% x1 = u;
% y1 = y;
% line(x1,y1,'Color','r')
% ax1 = gca; % current axes
% ax1.XColor = 'r';
% ax1.YColor = 'r';
% ax1_pos = ax1.Position; % position of first axes
% ax2 = axes('Position',ax1_pos,'XAxisLocation','top','YAxisLocation','right', 'Color','none');
% x2 = x;
% y2 = v;
% line(x2,y2,'Parent',ax2,'Color','k')
